!function(e){e.fn.ligerPanel=function(l){return e.ligerui.run.call(this,"ligerPanel",arguments)},e.ligerDefaults.Panel={width:400,height:300,title:"Panel",content:null,url:null,urlParms:null,frameName:null,data:null,showClose:!1,showToggle:!0,showRefresh:!1,icon:null,onClose:null,onClosed:null,onLoaded:null,onToggle:null},e.ligerDefaults.PanelString={refreshMessage:"刷新",closeMessage:"关闭",expandMessage:"展开",collapseMessage:"收起"},e.ligerMethos.Panel={},e.ligerui.controls.Panel=function(l,n){e.ligerui.controls.Panel.base.constructor.call(this,l,n)},e.ligerui.controls.Panel.ligerExtend(e.ligerui.core.UIComponent,{__getType:function(){return"Panel"},__idPrev:function(){return"Panel"},_extendMethods:function(){return e.ligerMethos.Panel},_init:function(){var l=this,n=this.options;e.ligerui.controls.Panel.base._init.call(this),n.content=n.content||e(l.element).html()},_render:function(){var l=this,n=this.options;l.panel=e(l.element).addClass("l-panel").html(""),l.panel.append('<div class="l-panel-header"><span></span><div class="icons"></div></div><div class="l-panel-content"></div>'),l.set(n),l.panel.find(".l-panel-header").hover(function(){e(this).addClass("l-panel-header-hover")},function(){e(this).removeClass("l-panel-header-hover")}),l.panel.bind("click.panel",function(n){var a=n.target||n.srcElement,i=e(a);if(i.hasClass("l-panel-header-toggle")){var t=!l.panel.find(".l-panel-header .l-panel-header-toggle:first").hasClass("l-panel-header-toggle-hide");l.toggle(),l.trigger("toggle",[t])}else i.hasClass("l-panel-header-close")?l.close():i.hasClass("l-panel-header-refresh")&&l.refresh()})},_setChildren:function(l){var n=this,a=(this.options,{input:["textbox","combobox","select"]}),i={grid:"ligerGrid",toolbar:"ligerToolBar",tree:"ligerTree",form:"ligerForm",menu:"ligerMenu",menubar:"ligerMenuBar",portal:"ligerPortal",combobox:"ligerComboBox",textbox:"ligerTextBox",spinner:"ligerSpinner",listbox:"ligerListBox",checkbox:"ligerCheckBox",radio:"ligerRadio",checkboxlist:"ligerCheckBoxList",radiolist:"ligerRadioList",popupedit:"ligerPopupEdit",button:"ligerButton",dateeditor:"ligerDateEditor",dialog:"ligerDialog",panel:"ligerPanel",layout:"ligerLayout",accordion:"ligerAccordion",tab:"ligerTab"};if(l&&l.length)for(var t=0;t<l.length;t++){var r=l[t],s=r.type,o=a[s]||"div",d=i[s];if(d){var p=document.createElement(o);n.panel.find(".l-panel-content").append(p);var h=e.extend({},r);h.type=null,e(p)[d](h)}}},collapse:function(){var e=this;this.options;e.panel.find(".l-panel-header .l-panel-header-toggle:first").hasClass("l-panel-header-toggle-hide")||e.toggle()},expand:function(){var e=this;this.options;e.panel.find(".l-panel-header .l-panel-header-toggle:first").hasClass("l-panel-header-toggle-hide")&&e.toggle()},toggle:function(){var e=this,l=this.options,n=e.panel.find(".l-panel-header .l-panel-header-toggle:first");n.hasClass("l-panel-header-toggle-hide")?(n.removeClass("l-panel-header-toggle-hide"),n.attr("title",l.collapseMessage)):(n.addClass("l-panel-header-toggle-hide"),n.attr("title",l.expandMessage)),e.panel.find(".l-panel-content:first").toggle()},refresh:function(){var e=this,l=this.options;e.set("url",l.url)},_setShowToggle:function(l){var n=this,a=this.options,i=n.panel.find(".l-panel-header:first");if(l){var t=e("<a class='l-panel-icon l-panel-header-toggle'></a>");t.appendTo(i.find(".icons")),t.attr("title",a.collapseMessage)}else i.find(".l-panel-header-toggle").remove()},_setContent:function(e){var l=this,n=(this.options,l.panel.find(".l-panel-content:first"));e&&n.html(e)},_setUrl:function(l){var n=this,a=this.options,i=n.panel.find(".l-panel-content:first");if(l){var t=e.isFunction(a.urlParms)?a.urlParms.call(n):a.urlParms;if(t)for(name in t)l+=-1==l.indexOf("?")?"?":"&",l+=name+"="+t[name];if(!n.jiframe){n.jiframe=e("<iframe frameborder='0'></iframe>");var r=a.frameName?a.frameName:"ligerpanel"+(new Date).getTime();n.jiframe.attr("name",r),n.jiframe.attr("id",r),i.prepend(n.jiframe),n.jiframe[0].panel=n,n.frame=window.frames[n.jiframe.attr("name")]}setTimeout(function(){0==i.find(".l-panel-loading:first").length&&i.append("<div class='l-panel-loading' style='display:block;'></div>");var a=e(".l-panel-loading:first",i);n.jiframe.attr("src",l).bind("load.panel",function(){a.hide(),n.trigger("loaded")})},0)}},_setShowClose:function(l){var n=this,a=this.options,i=n.panel.find(".l-panel-header:first");if(l){var t=e("<a class='l-panel-icon l-panel-header-close'></a>");t.appendTo(i.find(".icons")),t.attr("title",a.closeMessage)}else i.find(".l-panel-header-close").remove()},_setShowRefresh:function(l){var n=this,a=this.options,i=n.panel.find(".l-panel-header:first");if(l){var t=e("<a class='l-panel-icon l-panel-header-refresh'></a>");t.appendTo(i.find(".icons")),t.attr("title",a.refreshMessage)}else i.find(".l-panel-header-refresh").remove()},close:function(){var e=this;this.options;0!=e.trigger("close")&&(e.panel.remove(),e.trigger("closed"))},show:function(){this.panel.show()},_setIcon:function(e){var l=this;e?(l.panel.addClass("l-panel-hasicon"),l.panel.append('<img src="'+e+'" />')):(l.panel.removeClass("l-panel-hasicon"),l.panel.find("img").remove())},_setWidth:function(e){"string"==typeof e?e.indexOf("%")>-1?this.panel.width(e):this.panel.width(parseInt(e)):this.panel.width(e)},_setHeight:function(e){var l=this,n=(this.options,l.panel.find(".l-panel-header:first"));this.panel.find(".l-panel-content:first").height(e-n.height())},_setTitle:function(e){this.panel.find(".l-panel-header span:first").text(e)}})}(jQuery);