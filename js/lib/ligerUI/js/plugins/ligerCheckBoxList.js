!function(e){e.fn.ligerCheckBoxList=function(t){return e.ligerui.run.call(this,"ligerCheckBoxList",arguments)},e.ligerDefaults.CheckBoxList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,split:";",data:null,parms:null,url:null,urlParms:null,ajaxContentType:null,ajaxType:"post",onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null},e.ligerMethos.CheckBoxList=e.ligerMethos.CheckBoxList||{},e.ligerui.controls.CheckBoxList=function(t,i){e.ligerui.controls.CheckBoxList.base.constructor.call(this,t,i)},e.ligerui.controls.CheckBoxList.ligerExtend(e.ligerui.controls.Input,{__getType:function(){return"CheckBoxList"},_extendMethods:function(){return e.ligerMethos.CheckBoxList},_init:function(){e.ligerui.controls.CheckBoxList.base._init.call(this)},_render:function(){var t=this,i=this.options;t.data=i.data,t.valueField=null,e(this.element).is(":hidden")||e(this.element).is(":text")?(t.valueField=e(this.element),e(this.element).is(":text")&&t.valueField.hide()):i.valueFieldID?(t.valueField=e("#"+i.valueFieldID+":input,[name="+i.valueFieldID+"]:input"),0==t.valueField.length&&(t.valueField=e('<input type="hidden"/>')),t.valueField[0].id=t.valueField[0].name=i.valueFieldID):(t.valueField=e('<input type="hidden"/>'),t.valueField[0].id=t.valueField[0].name=t.id+"_val"),null==t.valueField[0].name&&(t.valueField[0].name=t.valueField[0].id),i.valueFieldCssClass&&t.valueField.addClass(i.valueFieldCssClass),t.valueField.attr("data-ligerid",t.id),e(this.element).is(":hidden")||e(this.element).is(":text")?t.checkboxList=e("<div></div>").insertBefore(this.element):t.checkboxList=e(this.element),t.checkboxList.html('<div class="l-checkboxlist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-checkboxlist-table"></table></div>').addClass("l-checkboxlist").append(t.valueField),t.checkboxList.table=e("table:first",t.checkboxList),t.set(i),t._addClickEven()},destroy:function(){this.checkboxList&&this.checkboxList.remove(),this.options=null,e.ligerui.remove(this)},clear:function(){this._changeValue(""),this.trigger("clear")},_setCss:function(e){e&&this.checkboxList.addClass(e)},_setDisabled:function(t){t?(this.checkboxList.addClass("l-checkboxlist-disabled"),e("input:checkbox",this.radioList).attr("disabled",!0)):(this.checkboxList.removeClass("l-checkboxlist-disabled"),e("input:checkbox",this.radioList).removeAttr("disabled"))},_setWidth:function(e){this.checkboxList.width(e)},_setHeight:function(e){this.checkboxList.height(e)},indexOf:function(e){var t=this,i=this.options;if(!t.data)return-1;for(var a=0,s=t.data.length;a<s;a++)if("object"==typeof e){if(t.data[a]==e)return a}else if(t.data[a][i.valueField].toString()==e.toString())return a;return-1},removeItems:function(t){var i=this;i.data&&(e(t).each(function(e,t){var a=i.indexOf(t);-1!=a&&i.data.splice(a,1)}),i.refresh())},removeItem:function(e){if(this.data){var t=this.indexOf(e);-1!=t&&(this.data.splice(t,1),this.refresh())}},insertItem:function(e,t){var i=this;i.data||(i.data=[]),i.data.splice(t,0,e),i.refresh()},addItems:function(t){var i=this;i.data||(i.data=[]),e(t).each(function(e,t){i.data.push(t)}),i.refresh()},addItem:function(e){var t=this;t.data||(t.data=[]),t.data.push(e),t.refresh()},_setValue:function(e){var t=this,i=this.options;i.value=e,t.valueField.val(i.value),this._dataInit()},setValue:function(e){this._setValue(e)},_setUrl:function(t){if(t){var i=this,a=this.options,s=e.isFunction(a.urlParms)?a.urlParms.call(i):a.urlParms;if(s)for(name in s)t+=-1==t.indexOf("?")?"?":"&",t+=name+"="+s[name];var l=e.isFunction(a.parms)?a.parms():a.parms;"application/json"==a.ajaxContentType&&"string"!=typeof l&&(l=liger.toJSON(l)),e.ajax({type:a.ajaxType||"post",url:t,data:l,cache:!1,dataType:"json",contentType:a.ajaxContentType,success:function(e){i.setData(e),i.trigger("success",[e])},error:function(e,t){i.trigger("error",[e,t])}})}},setUrl:function(e){return this._setUrl(e)},setParm:function(e,t){if(e){var i=this,a=i.get("parms");a||(a={}),a[e]=t,i.set("parms",a)}},clearContent:function(){var t=this;this.options;e("table",t.checkboxList).html("")},_setData:function(e){this.setData(e)},setData:function(e){var t=this;this.options;e&&e.length&&(t.data=e,t.refresh(),t.updateStyle())},refresh:function(){var e=this,t=this.options,i=this.data;if(this.clearContent(),i){for(var a=[],s=t.rowSize,l=!1,n=t.name||e.id,o=0;o<i.length;o++){var c=i[o][t.valueField],u=i[o][t.textField],r=e.id+"-"+o;o%s==0&&(l&&a.push("</tr>"),a.push("<tr>"),l=!0),a.push("<td><input type='checkbox' name='"+n+"' value='"+c+"' id='"+r+"'/><label for='"+r+"'>"+u+"</label></td>")}l&&a.push("</tr>"),e.checkboxList.table.append(a.join(""))}},_getValue:function(){var t=this,i=this.options,a=i.name||t.id,s=[];return e('input:checkbox[name="'+a+'"]:checked').each(function(){s.push(this.value)}),s.length?s.join(i.split):null},getValue:function(){return this._getValue()},getText:function(){var t=this,i=this.options,a=i.name||t.id,s=[];return e('input:checkbox[name="'+a+'"]:checked').each(function(){s.push(e(this).next("label").text())}),s.length?s.join(i.split):null},updateStyle:function(){this._dataInit()},_dataInit:function(){var e=this,t=(this.options,e.valueField.val());e._changeValue(t)},_changeValue:function(t){var i=this,a=this.options,s=a.name||i.id,l=t?t.split(a.split):[];e("input:checkbox[name='"+s+"']",i.checkboxList).each(function(){this.checked=e.inArray(this.value,l)>-1}),i.valueField.val(t),i.selectedValue=t},_addClickEven:function(){var e=this;this.options;e.checkboxList.click(function(t){var i=e.getValue();i&&e.valueField.val(i)})}})}(jQuery);