!function(i){var n=i.ligerui;n.windowCount=0,i.ligerWindow=function(i){return n.run.call(null,"ligerWindow",arguments,{isStatic:!0})},i.ligerWindow.show=function(n){return i.ligerWindow(n)},i.ligerDefaults.Window={showClose:!0,showMax:!0,showToggle:!0,showMin:!0,title:"window",load:!1,onLoaded:null,onClose:null,onRegain:null,onMax:null,modal:!1},i.ligerMethos.Window={},n.controls.Window=function(i){n.controls.Window.base.constructor.call(this,null,i)},n.controls.Window.ligerExtend(n.core.Win,{__getType:function(){return"Window"},__idPrev:function(){return"Window"},_extendMethods:function(){return i.ligerMethos.Window},_render:function(){var t=this,o=this.options;if(t.window=i('<div class="l-window"><div class="l-window-header"><div class="l-window-header-buttons"><div class="l-window-toggle"></div><div class="l-window-max"></div><div class="l-window-close"></div><div class="l-clear"></div></div><div class="l-window-header-inner"></div></div><div class="l-window-content"></div></div>'),t.element=t.window[0],t.window.content=i(".l-window-content",t.window),t.window.header=i(".l-window-header",t.window),t.window.buttons=i(".l-window-header-buttons:first",t.window),o.url)if(o.load)t.window.content.load(o.url,function(){t.trigger("loaded")}),t.window.content.addClass("l-window-content-scroll");else{var e=i("<iframe frameborder='0' src='"+o.url+"'></iframe>"),w="ligeruiwindow"+n.windowCount++;o.name&&(w=o.name),e.attr("name",w).attr("id",w),o.framename=w,e.appendTo(t.window.content),t.iframe=e}else if(o.content){var d=i("<div>"+o.content+"</div>");d.appendTo(t.window.content)}else o.target&&(t.window.content.append(o.target),o.target.show());this.mask(),t.active(),i("body").append(t.window),t.set({width:o.width,height:o.height});var s=0,l=0;null!=o.left?s=o.left:o.left=s=.5*(i(window).width()-t.window.width()),null!=o.top?l=o.top:o.top=l=.5*(i(window).height()-t.window.height())+i(window).scrollTop()-10,s<0&&(o.left=s=0),l<0&&(o.top=l=0),t.set(o),o.framename&&i(">iframe",t.window.content).attr("name",o.framename),o.showToggle||i(".l-window-toggle",t.window).remove(),o.showMax||i(".l-window-max",t.window).remove(),o.showClose||i(".l-window-close",t.window).remove(),t._saveStatus(),i.fn.ligerDrag&&(t.draggable=t.window.drag=t.window.ligerDrag({handler:".l-window-header-inner",onStartDrag:function(){t.active()},onStopDrag:function(){t._saveStatus()},animate:!1})),i.fn.ligerResizable&&(t.resizeable=t.window.resizable=t.window.ligerResizable({onStartResize:function(){t.active(),i(".l-window-max",t.window).removeClass("l-window-regain")},onStopResize:function(i,n){var o=0,e=0;return isNaN(parseInt(t.window.css("top")))||(o=parseInt(t.window.css("top"))),isNaN(parseInt(t.window.css("left")))||(e=parseInt(t.window.css("left"))),i.diffTop&&t.window.css({top:o+i.diffTop}),i.diffLeft&&t.window.css({left:e+i.diffLeft}),i.newWidth&&t.window.width(i.newWidth),i.newHeight&&t.window.content.height(i.newHeight-28),t._saveStatus(),!1}}),t.window.append("<div class='l-btn-nw-drop'></div>")),i(".l-window-toggle",t.window).click(function(){i(this).hasClass("l-window-toggle-close")?(t.collapsed=!1,i(this).removeClass("l-window-toggle-close")):(t.collapsed=!0,i(this).addClass("l-window-toggle-close")),t.window.content.slideToggle()}).hover(function(){t.window.drag&&t.window.drag.set("disabled",!0)},function(){t.window.drag&&t.window.drag.set("disabled",!1)}),i(".l-window-close",t.window).click(function(){if(0==t.trigger("close"))return!1;t.window.hide(),n.win.removeTask(t)}).hover(function(){t.window.drag&&t.window.drag.set("disabled",!0)},function(){t.window.drag&&t.window.drag.set("disabled",!1)}),i(".l-window-max",t.window).click(function(){if(i(this).hasClass("l-window-regain")){if(0==t.trigger("regain"))return!1;t.window.width(t._width).css({left:t._left,top:t._top}),t.window.content.height(t._height-28),i(this).removeClass("l-window-regain")}else{if(0==t.trigger("max"))return!1;t.window.width(i(window).width()-2).css({left:0,top:0}),t.window.content.height(i(window).height()-28).show(),i(this).addClass("l-window-regain")}})},_saveStatus:function(){var i=this;i._width=i.window.width(),i._height=i.window.height();var n=0,t=0;isNaN(parseInt(i.window.css("top")))||(n=parseInt(i.window.css("top"))),isNaN(parseInt(i.window.css("left")))||(t=parseInt(i.window.css("left"))),i._top=n,i._left=t},min:function(){this.window.hide(),this.minimize=!0,this.actived=!1},_setShowMin:function(t){var o=this;this.options;t?o.winmin||(o.winmin=i('<div class="l-window-min"></div>').prependTo(o.window.buttons).click(function(){o.min()}),n.win.addTask(o)):o.winmin&&(o.winmin.remove(),o.winmin=null)},_setLeft:function(i){null!=i&&this.window.css({left:i})},_setTop:function(i){null!=i&&this.window.css({top:i})},_setWidth:function(i){i>0&&this.window.width(i)},_setHeight:function(i){i>28&&this.window.content.height(i-28)},_setTitle:function(n){n&&i(".l-window-header-inner",this.window.header).html(n)},_setUrl:function(i){var n=this,t=this.options;t.url=i,t.load?n.window.content.html("").load(t.url,function(){if(0==n.trigger("loaded"))return!1}):n.jiframe&&n.jiframe.attr("src",t.url)},hide:function(){this.options;this.unmask(),this.window.hide()},show:function(){this.options;this.mask(),this.window.show()},remove:function(){this.options;this.unmask(),this.window.remove()},active:function(){var t=this;this.options;if(t.minimize){var o=t._width,e=t._height,w=t._left,d=t._top;t.maximum&&(o=i(window).width(),e=i(window).height(),w=d=0,n.win.taskbar&&(e-=n.win.taskbar.outerHeight(),n.win.top&&(d+=n.win.taskbar.outerHeight()))),t.set({width:o,height:e,left:w,top:d})}t.actived=!0,t.minimize=!1,n.win.setFront(t),t.show(),n.win.setFront(this)},setUrl:function(i){return _setUrl(i)}})}(jQuery);